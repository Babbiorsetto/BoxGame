0. Copertina
Relazione blabla
componenti
Alessandro Rubino
Marco Filippo Sameh Losbefero

1. Guida d'uso
Descrizione del gioco
BoxGame è un gioco eseguibile su piattaforma Unix realizzato in modalità client/server. 
Il server mantiene tutte le informazioni necessarie al progresso della partita e relative agli account dei giocatori, si occupa sia dell'hostaggio delle sessioni di gioco, sia del login e della registrazione dei giocatori.
Il client consente al giocatore di collegarsi al server per registrarsi o effettuare il login e conseguentemente giocare. Ogni giocatore è dotato di una copia(?) del client di gioco dal quale può connettersi al servizio(?) del server.
All'inizio della partita i giocatori si troverano collocati su una mappa bidimensionale, in cui sono presenti pacchi(o scatole) da consegnare, i punti di consegna e gli ostacoli, oltre ai giocatori stessi. 
La partita prosegue a turni, ad ogni giocatore viene assegnato un turno in cui può muoversi in una direzione(N, S, E, O), raccogliere una scatola o depositarla.
Ognuna delle azioni descritte costa un turno. Inoltre, se un giocatore tenta di muoversi in una casella occupata da un ostacolo o da un altro giocatore, egli perderà il turno senza essersi mosso.
Ad ogni pacco è assegnata una precisa scadenza, cioè un numero di turni dopo la raccolta da parte del giocatore al cui scadere il pacco sparisce. 
Nel momento in cui raccoglie un pacco, il giocatore ha a disposizione quel numero preciso di turni per consegnarlo.  
La partita finisce quando non ci sono più pacchi presenti sulla mappa e vince il giocatore che ne ha consegnati di più.
Compilazione
La compilazione si avvale del programma a linea di comando make e del compilatore gcc. 
Nella directory di lavoro "BoxGame", eseguire il comando "make install" per creare le directory necessarie alla compilazione. 
Per compilare server e client eseguire "make bin/server" e "make bin/client".
Esecuzione
Una volta compilati, lanciare il server con "./bin/server PORT_N" dove PORT_N è un intero compreso fra 1024 e 65535. Mentre il server è in esecuzione, lanciare il client con "./bin/client IP_ADDRESS PORT_N" dove IP_ADDRESS è un indirizzo IPv4 valido identificativo della macchina che esegue il server e PORT_N è il port number scelto per il server.
Il client presenterà un'interfaccia che permette la scelta fra registrazione e login. Se non si possiede un account, selezionare registrazione con la modalità indicata sul terminale e inserire le credenziali. Se lo username inserito è disponibile, la registrazione verrà effettuata e si potrà accedere al gioco. 
Riavviare il client ed effettuare il login, seguendo sempre la modalità descritta dal client all'apertura. Attendere che il client comunichi il successo del login e inserisca il giocatore nella partita.
Durante il gioco, il client visualizzerà la mappa, i giocatori connessi, i loro punteggi e il giocatore di turno. Queste informazioni saranno aggiornate al passare del turno di ciascun giocatore. 
Ciascun elemento presente nella mappa è rappresentato da un simbolo:
"Y" indica la propria posizione sulla mappa;
"P" indica la posizione degli altri giocatori sulla mappa;
"1" indica la posizione di un pacco sulla mappa;
"A" indica la posizione dei punti di consegna sulla mappa;
"X" indica la posizione degli ostacoli scoperti;
"-" indica le caselle navigabili e gli ostacoli ancora non scoperti dal giocatore.
Quando arriva il turno del giocatore, l'interfaccia visualizzerà i comandi disponibili. Non è possibile prendere un pacco se non è presente nella casella occupata dal giocatore. Non è possibile abbandonare un pacco in una casella che non sia di consegna. Non è possibile muoversi in una casella dove è presente un altro giocatore o un ostacolo. Tentare queste azioni comporterà la perdita del turno attuale. Il movimento verso un bordo della mappa porterà il giocatore al punto corrispondente dal lato opposto.
Qualora un giocatore abbandoni una partita in corso, potrà rientrare conservando il proprio punteggio effettuando nuovamente il login entro la fine della partita. Al termine di una partita il server genererà automaticamente una nuova sessione. I giocatori connessi verranno inseriti nella nuova partita, quelli disconnessi saranno eliminati.

Comunicazione tra client e server
La comunicazione tra i client ed il server avviene tramite l'utilizzo di una socket Unix. All'avvio, il server inizia un thread che apre la socket e resta in attesa di connessioni sulle interfacce di rete della macchina su cui gira. Il server resterà in attesa finché non si collega alla partita almeno un giocatore.
Il client invece, all'avvio apre la socket e offre all'utente la possibilità di scegliere tra registrazione e login, dopodiché raccoglie i dati necessari all'operazione (comando, username, password) e li invia in sequenza al server tramite una serie di chiamate "write" effettuate sulla socket, dopodiché resta in attesa di un messaggio dal server che indicherà l'esito dell'operazione di login o registrazione.
Nel dettaglio, la comunicazione avviene nel seguente modo:
Il server viene avviato, apre la socket e avvia il thread che resta in ascolto in attesa di connessioni.
Il client viene avviato, apre la socket e chiede all'utente se vuole registrarsi o effettuare il login.
L'utente del client sceglie di registrarsi (scrive 'r' come comando nel client)
    Il client manda la lettera 'r' al client, che descrive il comando che l'utente ha inserito.
    Subito dopo, il client manda 'username size', 'username', 'password size', 'password'
    Il server quindi confronta i dati ricevuti e controlla se l'utente è già registrato o meno.
    Nel caso in cui la registrazione va a buon fine, il server risponde 't' e chiude la connessione e il thread.
        Il client conferma all'utente l'iscrizione e termina.
L'utente del client vuole effettuare il login (scrive 'l' come comando nel client)
    Il client manda 'l' al server.
    Subito dopo, il client manda 'username size', 'username', 'password size', 'password'
    Il server risponde 't' e inserisce l'utente nel gioco, o lo reinserisce se era uscito.
        Il client entra in loop di gioco.
    Il server risponde 'f' perche' credenziali errate.
        Il client chiede ancora credenziali.
    Il server risponde 'a' perche' credenziali giuste ma utente gia' in gioco e attivo.
        Il client chiede ancora credenziali.
In qualsiasi momento, se il client viene chiuso dall'utente, il server chiude a sua volta la connessione e termina il thread.

Una volta che un giocatore effettua con successo il login ed entra nel loop di gioco, la comunicazione tra client e server avviene nel seguente modo:
Quando è il turno del giocatore, il server manda 'c' al client
    Il client prende dal giocatore il comando da effettuare ('n', 'e', 'o', 's', 'd', 'p', 'q') e lo manda al server che sta in ascolto
    Il server riceve il comando e manda avanti la partita
In qualsiasi momento il server può mandare un messaggio ai client, ad esempio quando deve aggiornare la mappa di gioco dei giocatori dopo l'esecuzione di un turno. Quindi manda ai client 's', la lunghezza del messaggio(un intero) e il messaggio (una stringa terminata da null)
    Il client riceve il messaggio e lo stampa su schermo

